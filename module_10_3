import threading
from random import randint
from threading import Lock, Thread
from time import sleep


class Bank:
    def __init__(self):
        self.balance = 0
        self.lock = Lock()

    def deposit(self):
        for i in range(100):
            if self.balance >= 500 and self.lock.locked():
                self.lock.release()
            z = randint(50, 500)
            self.balance += z
            print(f'Пополнение:{z}. Баланс:{self.balance}' + '\n')
            sleep(0.001)

    def take(self):
        for i in range(100):
            x = randint(50, 500)
            print(f'Запрос на {x}' + '\n')
            if x <= self.balance:
                self.balance -= x
                print(f'Снятие: {x}. Баланс: {self.balance}.' + '\n')
            else:
                print(f'Запрос отклонен, недостаточно средств' + '\n')
                self.lock.acquire()
                sleep(0.001)


bk = Bank()

th1 = threading.Thread(target=Bank.deposit, args=(bk,))
th2 = threading.Thread(target=Bank.take, args=(bk,))

th1.start()
th2.start()
th1.join()
th2.join()

print(f'Итоговый баланс: {bk.balance}')

Консоль:
C:\Users\Дом\PycharmProjects\djangoProject\venv\Scripts\python.exe C:/Users/Дом/PycharmProjects/djangoProject/Задания/module_10_3_4.py

Пополнение:278. Баланс:278

Запрос на 306

Запрос отклонен, недостаточно средств

Пополнение:351. Баланс:629
Запрос на 233

Снятие: 233. Баланс: 396.


Запрос на 173

Снятие: 173. Баланс: 223.

Запрос на 167

Снятие: 167. Баланс: 56.

Запрос на 339

Запрос отклонен, недостаточно средств

Пополнение:271. Баланс:327

Пополнение:477. Баланс:804

Пополнение:278. Баланс:1082

Пополнение:302. Баланс:1384

Запрос на 387

Снятие: 387. Баланс: 997.

Запрос на 231

Снятие: 231. Баланс: 766.

Запрос на 225

Снятие: 225. Баланс: 541.

Запрос на 149

Снятие: 149. Баланс: 392.

Запрос на 251

Снятие: 251. Баланс: 141.

Запрос на 323

Запрос отклонен, недостаточно средств

Пополнение:450. Баланс:591

Запрос на 208

Снятие: 208. Баланс: 383.

Запрос на 314

Снятие: 314. Баланс: 69.

Запрос на 488

Запрос отклонен, недостаточно средств

Пополнение:490. Баланс:559

Пополнение:421. Баланс:980

Пополнение:135. Баланс:1115

Запрос на 493

Снятие: 493. Баланс: 622.

Запрос на 491

Снятие: 491. Баланс: 131.

Запрос на 79

Снятие: 79. Баланс: 52.

Запрос на 304

Запрос отклонен, недостаточно средств

Пополнение:481. Баланс:533

Запрос на 244

Снятие: 244. Баланс: 289.

Запрос на 433

Запрос отклонен, недостаточно средств

Пополнение:147. Баланс:436

Пополнение:123. Баланс:559

Пополнение:186. Баланс:745

Пополнение:260. Баланс:1005
Запрос на 66


Снятие: 66. Баланс: 939.

Запрос на 313

Снятие: 313. Баланс: 626.

Запрос на 132

Снятие: 132. Баланс: 494.

Запрос на 378

Снятие: 378. Баланс: 116.

Запрос на 357

Запрос отклонен, недостаточно средств

Пополнение:56. Баланс:172

Запрос на 258

Запрос отклонен, недостаточно средств

Пополнение:411. Баланс:583

Пополнение:304. Баланс:887

Пополнение:322. Баланс:1209
Запрос на 220

Снятие: 220. Баланс: 989.


Запрос на 136

Снятие: 136. Баланс: 853.

Запрос на 227

Снятие: 227. Баланс: 626.

Запрос на 121

Снятие: 121. Баланс: 505.

Запрос на 328

Снятие: 328. Баланс: 177.

Запрос на 63

Снятие: 63. Баланс: 114.

Запрос на 58

Снятие: 58. Баланс: 56.

Запрос на 135

Запрос отклонен, недостаточно средств

Пополнение:284. Баланс:340
Запрос на 454

Запрос отклонен, недостаточно средств


Пополнение:220. Баланс:560

Пополнение:223. Баланс:783

Запрос на 56
Пополнение:428. Баланс:1211


Снятие: 56. Баланс: 1155.

Запрос на 55

Снятие: 55. Баланс: 1100.

Запрос на 438

Снятие: 438. Баланс: 662.

Запрос на 348

Снятие: 348. Баланс: 314.

Запрос на 239

Снятие: 239. Баланс: 75.

Запрос на 357

Запрос отклонен, недостаточно средств

Запрос на 121

Запрос отклонен, недостаточно средств

Пополнение:307. Баланс:382

Пополнение:448. Баланс:830

Пополнение:312. Баланс:1142

Пополнение:122. Баланс:1264

Запрос на 363

Снятие: 363. Баланс: 901.

Запрос на 161

Снятие: 161. Баланс: 740.

Запрос на 137

Снятие: 137. Баланс: 603.

Запрос на 278

Снятие: 278. Баланс: 325.

Запрос на 403

Запрос отклонен, недостаточно средств

Запрос на 333

Запрос отклонен, недостаточно средств
Пополнение:210. Баланс:535


Пополнение:107. Баланс:642

Пополнение:445. Баланс:1087

Запрос на 374

Снятие: 374. Баланс: 713.

Запрос на 445

Снятие: 445. Баланс: 268.

Запрос на 100

Снятие: 100. Баланс: 168.

Запрос на 121

Снятие: 121. Баланс: 47.

Запрос на 288

Запрос отклонен, недостаточно средств

Запрос на 148

Запрос отклонен, недостаточно средств

Пополнение:354. Баланс:401

Пополнение:123. Баланс:524

Пополнение:264. Баланс:788

Пополнение:256. Баланс:1044
Запрос на 162

Снятие: 162. Баланс: 882.

Запрос на 425

Снятие: 425. Баланс: 457.

Запрос на 456

Снятие: 456. Баланс: 1.

Запрос на 269

Запрос отклонен, недостаточно средств


Запрос на 496

Запрос отклонен, недостаточно средств

Пополнение:449. Баланс:450

Пополнение:119. Баланс:569

Пополнение:375. Баланс:944

Пополнение:164. Баланс:1108

Запрос на 262

Снятие: 262. Баланс: 846.

Запрос на 254

Снятие: 254. Баланс: 592.

Запрос на 242

Снятие: 242. Баланс: 350.

Запрос на 489

Запрос отклонен, недостаточно средств

Запрос на 436
Пополнение:428. Баланс:778


Снятие: 436. Баланс: 342.

Запрос на 275

Снятие: 275. Баланс: 67.

Запрос на 398

Запрос отклонен, недостаточно средств

Пополнение:233. Баланс:300

Пополнение:455. Баланс:755

Пополнение:381. Баланс:1136

Пополнение:378. Баланс:1514
Запрос на 254

Снятие: 254. Баланс: 1260.

Запрос на 111

Снятие: 111. Баланс: 1149.

Запрос на 169

Снятие: 169. Баланс: 980.


Запрос на 384

Снятие: 384. Баланс: 596.

Запрос на 490

Снятие: 490. Баланс: 106.

Запрос на 164

Запрос отклонен, недостаточно средств

Пополнение:323. Баланс:429
Запрос на 235


Снятие: 235. Баланс: 194.

Запрос на 438

Запрос отклонен, недостаточно средств

Пополнение:483. Баланс:677

Пополнение:458. Баланс:1135

Пополнение:430. Баланс:1565
Запрос на 264

Снятие: 264. Баланс: 1301.

Запрос на 490

Снятие: 490. Баланс: 811.

Запрос на 62


Снятие: 62. Баланс: 749.

Запрос на 448

Снятие: 448. Баланс: 301.

Запрос на 123

Снятие: 123. Баланс: 178.

Запрос на 385

Запрос отклонен, недостаточно средств

Пополнение:446. Баланс:624

Запрос на 90

Снятие: 90. Баланс: 534.

Запрос на 492

Снятие: 492. Баланс: 42.

Запрос на 232

Запрос отклонен, недостаточно средств

Пополнение:343. Баланс:385

Пополнение:192. Баланс:577

Пополнение:228. Баланс:805

Пополнение:78. Баланс:883

Запрос на 71

Снятие: 71. Баланс: 812.

Запрос на 423

Снятие: 423. Баланс: 389.

Запрос на 104

Снятие: 104. Баланс: 285.

Запрос на 438

Запрос отклонен, недостаточно средств

Пополнение:265. Баланс:550
Запрос на 399

Снятие: 399. Баланс: 151.

Запрос на 119

Снятие: 119. Баланс: 32.

Запрос на 67


Запрос отклонен, недостаточно средств

Пополнение:52. Баланс:84

Пополнение:180. Баланс:264

Пополнение:414. Баланс:678

Пополнение:476. Баланс:1154

Пополнение:80. Баланс:1234

Запрос на 159

Снятие: 159. Баланс: 1075.

Запрос на 76

Снятие: 76. Баланс: 999.

Запрос на 115

Снятие: 115. Баланс: 884.

Запрос на 460

Снятие: 460. Баланс: 424.

Запрос на 188

Снятие: 188. Баланс: 236.

Запрос на 105

Снятие: 105. Баланс: 131.

Запрос на 381

Запрос отклонен, недостаточно средств

Пополнение:451. Баланс:582

Пополнение:314. Баланс:896

Запрос на 373

Снятие: 373. Баланс: 523.

Запрос на 296

Снятие: 296. Баланс: 227.

Запрос на 313

Запрос отклонен, недостаточно средств

Пополнение:469. Баланс:696

Пополнение:451. Баланс:1147

Пополнение:199. Баланс:1346

Пополнение:420. Баланс:1766

Пополнение:52. Баланс:1818

Пополнение:363. Баланс:2181

Пополнение:174. Баланс:2355

Пополнение:155. Баланс:2510

Пополнение:191. Баланс:2701

Пополнение:452. Баланс:3153

Пополнение:213. Баланс:3366

Пополнение:445. Баланс:3811

Пополнение:277. Баланс:4088

Пополнение:169. Баланс:4257

Пополнение:486. Баланс:4743

Пополнение:54. Баланс:4797

Пополнение:137. Баланс:4934

Пополнение:310. Баланс:5244

Пополнение:319. Баланс:5563

Пополнение:365. Баланс:5928

Пополнение:293. Баланс:6221

Пополнение:467. Баланс:6688

Пополнение:242. Баланс:6930

Пополнение:165. Баланс:7095

Пополнение:423. Баланс:7518

Пополнение:408. Баланс:7926

Пополнение:156. Баланс:8082

Пополнение:97. Баланс:8179

Пополнение:113. Баланс:8292

Пополнение:297. Баланс:8589

Пополнение:329. Баланс:8918

Пополнение:320. Баланс:9238

Пополнение:104. Баланс:9342

Пополнение:141. Баланс:9483

Пополнение:99. Баланс:9582

Пополнение:300. Баланс:9882

Пополнение:196. Баланс:10078

Пополнение:173. Баланс:10251

Пополнение:137. Баланс:10388

Пополнение:374. Баланс:10762

Итоговый баланс: 10762

Process finished with exit code 0
